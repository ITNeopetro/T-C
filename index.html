<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Neopetro T&C Acknowledgement</title>

<!-- PDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
body{
  font-family:Arial,Helvetica,sans-serif;
  background:#f4f6f8;
  margin:0;
  padding:20px;
}

/* Container */
.container{
  max-width:900px;
  margin:auto;
  background:#fff;
  padding:30px;
  border-radius:8px;
  box-shadow:0 4px 12px rgba(0,0,0,.08);
}

/* Header */
.header{
  text-align:center;
  margin-bottom:25px;
}
.header img{
  max-width:180px;
  margin-bottom:10px;
}
.header h1{
  font-size:22px;
  margin-bottom:5px;
}
.header p{
  font-size:13px;
  margin:2px 0;
}

/* Form */
label{
  font-weight:bold;
  font-size:13px;
  margin-top:12px;
  display:block;
}

input[type="text"],
input[type="date"],
select,
textarea{
  width:100%;
  padding:8px;
  font-size:14px;
  border:1px solid #ccc;
  border-radius:4px;
  box-sizing:border-box;
  margin-top:5px;
}

textarea{
  height:250px;
  resize:none;
  background:#fafafa;
}

/* Signature */
.signature-container{
  display:flex;
  gap:20px;
  margin-top:20px;
  flex-wrap:wrap;
}

.signature-box{
  max-width:400px;
  flex:1;
}

.signature-box canvas{
  border:1px solid #333;
  width:100%;
  height:150px;
  touch-action:none;
}

#clear-signature{
  margin-top:8px;
  padding:8px;
  font-size:14px;
  background:#0b5ed7;
  color:#fff;
  border:none;
  border-radius:4px;
  cursor:pointer;
}
#clear-signature:hover{
  background:#094bb5;
}

/* Checkbox */
.side-panel{
  flex:1;
}
.side-panel label{
  font-weight:normal;
  font-size:14px;
}

/* Buttons */
button[type="submit"]{
  margin-top:25px;
  padding:12px 30px;
  font-size:15px;
  background:#0b5ed7;
  color:#fff;
  border:none;
  border-radius:5px;
  cursor:pointer;
  width:100%;
}
button[type="submit"]:hover{
  background:#094bb5;
}

/* Errors */
.error{
  color:red;
  font-size:13px;
}

/* Popup */
#popup{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.5);
  z-index:1000;
}
#popupContent{
  background:#fff;
  padding:25px;
  max-width:420px;
  margin:120px auto;
  border-radius:8px;
  text-align:center;
  box-shadow:0 4px 12px rgba(0,0,0,.2);
}
.popup-btn{
  width:100%;
  padding:10px;
  font-size:15px;
  margin-top:10px;
  background:#0b5ed7;
  color:#fff;
  border:none;
  border-radius:5px;
  cursor:pointer;
}
.popup-btn:hover{
  background:#094bb5;
}
.popup-btn.secondary{
  background:#999;
}
.popup-btn.secondary:hover{
  background:#777;
}
</style>
</head>

<body>

<div class="container">

<div class="header">
  <img src="NEOPETRO LOGO.png" alt="Neopetro Logo">
  <h1>NEOPETRO SDN BHD</h1>
  <p><strong>TERMS & CONDITIONS ACKNOWLEDGEMENT</strong></p>
</div>

<form id="tcForm">

<label>Full Name *</label>
<input type="text" id="name">
<div id="nameError" class="error"></div>

<label>Position / Rank *</label>
<select id="position">
  <option value="">-- Select Rank --</option>
  <option>Onshore Staff</option>
  <option>Master</option>
  <option>Chief Officer</option>
  <option>Chief Engineer</option>
  <option>Second Officer</option>
  <option>Second Engineer</option>
  <option>Bosun</option>
  <option>Able Bodied</option>
  <option>Greaser</option>
  <option>Oiler</option>
  <option>Cook</option>
</select>
<div id="positionError" class="error"></div>

<label>Vessel/Office *</label>
<select id="vessel">
  <option value="">-- Select Vessel --</option>
  <option>Office</option>
  <option>Neopetro 8</option>
  <option>Neopetro 10</option>
  <option>Neopetro 11</option>
  <option>Neopetro 12</option>
  <option>Neopetro 18</option>
  <option>NP Explorer</option>
</select>
<div id="vesselError" class="error"></div>

<label>Date *</label>
<input type="date" id="date">
<div id="dateError" class="error"></div>

<label>Terms & Conditions</label>
<textarea readonly>
I acknowledge that I have read, understood, and agree to comply with all NEOPETRO SDN BHD policies and procedures.

I understand that it is my responsibility to stay informed and comply with all applicable company rules, safety requirements, and ethical standards.

Violation of any policy may result in disciplinary action, up to and including termination or legal action.
</textarea>

<div class="signature-container">

  <div class="signature-box">
    <label>Signature *</label>
    <canvas id="signature-pad"></canvas>
    <button type="button" id="clear-signature">Clear Signature</button>
  </div>

  <div class="side-panel">
    <label>
      <input type="checkbox" id="acknowledgeCheckbox">
      I confirm that I have read, understood, and agree to comply with the above terms and policies. *
    </label>
    <div id="checkboxError" class="error"></div>
  </div>

</div>

<button type="submit">Submit Acknowledgement</button>

</form>
</div>

<!-- Popup -->
<div id="popup">
  <div id="popupContent">
    <h3>Submission Recorded</h3>
    <p>Your acknowledgement has been successfully submitted.</p>
    <button id="generatePdfBtn" class="popup-btn">Generate PDF</button>
    <button id="closePopupBtn" class="popup-btn secondary">Close</button>
  </div>
</div>

<!-- JS -->
<script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<script>
const canvas = document.getElementById('signature-pad');
const signaturePad = new SignaturePad(canvas,{minWidth:1,maxWidth:2});

emailjs.init("e11xX_5IIA36HGfyg");

document.getElementById('clear-signature').onclick = () => signaturePad.clear();

document.getElementById('tcForm').addEventListener('submit', function(e){
  e.preventDefault();

  document.querySelectorAll(".error").forEach(el=>el.innerText="");

  let valid = true;
  const name = document.getElementById('name').value.trim();
  const position = document.getElementById('position').value.trim();
  const vessel = document.getElementById('vessel').value.trim();
  const date = document.getElementById('date').value;
  const checkbox = document.getElementById('acknowledgeCheckbox').checked;

  if(!name){nameError.innerText="Full Name is mandatory"; valid=false;}
  if(!position){positionError.innerText="Position/Rank is mandatory"; valid=false;}
  if(!vessel){vesselError.innerText="Vessel is mandatory"; valid=false;}
  if(!date){dateError.innerText="Date is mandatory"; valid=false;}
  if(!checkbox){checkboxError.innerText="You must confirm acknowledgment"; valid=false;}
  if(signaturePad.isEmpty()){canvas.style.borderColor='red'; valid=false;}
  else {canvas.style.borderColor='#333';}

  if(!valid) return;

  const signatureBase64 = signaturePad.toDataURL("image/png");

  emailjs.send("service_zdyjwv1","template_1a0dwtt",{
    name,
    position,
    vessel,
    date,
    signature: signatureBase64
  }).then(()=>{
    document.getElementById('popup').style.display="block";
  });
});

document.getElementById("generatePdfBtn").onclick = () => {
  html2pdf()
    .from(document.querySelector(".container"))
    .set({
      margin:10,
      filename:"Neopetro_Terms_Acknowledgement.pdf",
      html2canvas:{scale:2},
      jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}
    })
    .save();
};

document.getElementById('closePopupBtn').onclick = () => {
  location.reload();
};
</script>

</body>
</html>
